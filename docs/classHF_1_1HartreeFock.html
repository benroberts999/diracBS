<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ampsci: HF::HartreeFock</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ampsci
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceHF.html">HF</a></li><li class="navelem"><a class="el" href="classHF_1_1HartreeFock.html">HartreeFock</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classHF_1_1HartreeFock-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">HF::HartreeFock</div>  </div>
</div><!--header-->
<div class="contents">

<p>Solves relativistic Hartree-Fock equations.  
 <a href="classHF_1_1HartreeFock.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="HartreeFock_8hpp_source.html">HartreeFock.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adf92345591b8ed9613784b7bc2981ffd"><td class="memItemLeft" align="right" valign="top"><a id="adf92345591b8ed9613784b7bc2981ffd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#adf92345591b8ed9613784b7bc2981ffd">HartreeFock</a> (std::shared_ptr&lt; const <a class="el" href="classGrid.html">Grid</a> &gt;, const std::vector&lt; double &gt; &amp;in_vnuc, std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; *in_core, const <a class="el" href="classRadiativePotential_1_1Vrad.html">RadiativePotential::Vrad</a> *const in_vrad=nullptr, double m_alpha=<a class="el" href="namespacePhysConst.html#a55902d21a45f0deca899be0c26404187">PhysConst::alpha</a>, Method method=Method::HartreeFock, double x_Breit=0.0, double eps_HF=0.0)</td></tr>
<tr class="memdesc:adf92345591b8ed9613784b7bc2981ffd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method is enum class, eps_HF is convergence goal. <br /></td></tr>
<tr class="separator:adf92345591b8ed9613784b7bc2981ffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a541c73462f22e9e6505cf8c5ca95f15f"><td class="memItemLeft" align="right" valign="top"><a id="a541c73462f22e9e6505cf8c5ca95f15f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>HartreeFock</b> (<a class="el" href="classWavefunction.html">Wavefunction</a> *wf, Method method=Method::HartreeFock, double x_Breit=0.0, double eps_HF=0.0)</td></tr>
<tr class="separator:a541c73462f22e9e6505cf8c5ca95f15f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5aa7f2c47d4ce867dc9371fb5c38e13"><td class="memItemLeft" align="right" valign="top"><a id="ae5aa7f2c47d4ce867dc9371fb5c38e13"></a>
const std::vector&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#ae5aa7f2c47d4ce867dc9371fb5c38e13">solveCore</a> ()</td></tr>
<tr class="memdesc:ae5aa7f2c47d4ce867dc9371fb5c38e13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves <a class="el" href="namespaceHF.html" title="Functions and classes for Hartree-Fock. ">HF</a> equations self-consitantly for core orbs. Produces Vdir. <br /></td></tr>
<tr class="separator:ae5aa7f2c47d4ce867dc9371fb5c38e13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d8caee3d4535cb823430f37e53d61cf"><td class="memItemLeft" align="right" valign="top"><a id="a7d8caee3d4535cb823430f37e53d61cf"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#a7d8caee3d4535cb823430f37e53d61cf">solveValence</a> (std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; *valence, const bool print=true)</td></tr>
<tr class="memdesc:a7d8caee3d4535cb823430f37e53d61cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves <a class="el" href="namespaceHF.html" title="Functions and classes for Hartree-Fock. ">HF</a> for valence list; valence states must already be present in WaveFunction (bad, instead, give it a vector of DiracSpinors!) <br /></td></tr>
<tr class="separator:a7d8caee3d4535cb823430f37e53d61cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c64e2ae41efdb5b1a45fe0f15039d09"><td class="memItemLeft" align="right" valign="top"><a id="a2c64e2ae41efdb5b1a45fe0f15039d09"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#a2c64e2ae41efdb5b1a45fe0f15039d09">solveBrueckner</a> (std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; *valence, const <a class="el" href="classMBPT_1_1CorrelationPotential.html">MBPT::CorrelationPotential</a> &amp;Sigma2, const bool print=true)</td></tr>
<tr class="memdesc:a2c64e2ae41efdb5b1a45fe0f15039d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves HF+Sigma equation: valence Brueckner orbitals. Writes to valence. <br /></td></tr>
<tr class="separator:a2c64e2ae41efdb5b1a45fe0f15039d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a252b2f63cdcb89d1e7372a3cd27cd1f7"><td class="memItemLeft" align="right" valign="top"><a id="a252b2f63cdcb89d1e7372a3cd27cd1f7"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#a252b2f63cdcb89d1e7372a3cd27cd1f7">calculateCoreEnergy</a> () const</td></tr>
<tr class="memdesc:a252b2f63cdcb89d1e7372a3cd27cd1f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the <a class="el" href="namespaceHF.html" title="Functions and classes for Hartree-Fock. ">HF</a> core energy. <br /></td></tr>
<tr class="separator:a252b2f63cdcb89d1e7372a3cd27cd1f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f9afae7f4e5dc24505057f36e7cc44f"><td class="memItemLeft" align="right" valign="top"><a id="a0f9afae7f4e5dc24505057f36e7cc44f"></a>
const std::vector&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#a0f9afae7f4e5dc24505057f36e7cc44f">get_vdir</a> () const</td></tr>
<tr class="memdesc:a0f9afae7f4e5dc24505057f36e7cc44f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns const ref to V_dir (Direct <a class="el" href="namespaceHF.html" title="Functions and classes for Hartree-Fock. ">HF</a> potential) <br /></td></tr>
<tr class="separator:a0f9afae7f4e5dc24505057f36e7cc44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5b4f01743c2fb378e79579115a58cb8"><td class="memItemLeft" align="right" valign="top"><a id="ae5b4f01743c2fb378e79579115a58cb8"></a>
const std::vector&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#ae5b4f01743c2fb378e79579115a58cb8">get_vdir_single</a> (const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fa) const</td></tr>
<tr class="memdesc:ae5b4f01743c2fb378e79579115a58cb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single-electron contribution to Vdir (does not include x*[2j+1]). Note: Fa MUST be a core state, otherwise UB. <br /></td></tr>
<tr class="separator:ae5b4f01743c2fb378e79579115a58cb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09d80dd0e27f3bfa87472ffdcbafba36"><td class="memItemLeft" align="right" valign="top"><a id="a09d80dd0e27f3bfa87472ffdcbafba36"></a>
<a class="el" href="classDiracSpinor.html">DiracSpinor</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#a09d80dd0e27f3bfa87472ffdcbafba36">calc_vexFa</a> (const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fa) const</td></tr>
<tr class="memdesc:a09d80dd0e27f3bfa87472ffdcbafba36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates exchange term Vex*Fa (calls static version with <a class="el" href="namespaceHF.html" title="Functions and classes for Hartree-Fock. ">HF</a> core) <br /></td></tr>
<tr class="separator:a09d80dd0e27f3bfa87472ffdcbafba36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b47229d85cfe4ce34a58a120671434"><td class="memItemLeft" align="right" valign="top"><a id="ad5b47229d85cfe4ce34a58a120671434"></a>
<a class="el" href="classDiracSpinor.html">DiracSpinor</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#ad5b47229d85cfe4ce34a58a120671434">calc_vexFa_core</a> (const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fa) const</td></tr>
<tr class="memdesc:ad5b47229d85cfe4ce34a58a120671434"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same as 'calc_vexFa'; Fa must be in core [y_ab exist already, so faster]. <br /></td></tr>
<tr class="separator:ad5b47229d85cfe4ce34a58a120671434"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addf451a38799ca599b7620c75d850a97"><td class="memItemLeft" align="right" valign="top"><a id="addf451a38799ca599b7620c75d850a97"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#addf451a38799ca599b7620c75d850a97">excludeExchangeQ</a> () const</td></tr>
<tr class="memdesc:addf451a38799ca599b7620c75d850a97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true of exchange not included. <br /></td></tr>
<tr class="separator:addf451a38799ca599b7620c75d850a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a748a7036e83e7370dfddb1aefb96307e"><td class="memItemLeft" align="right" valign="top"><a id="a748a7036e83e7370dfddb1aefb96307e"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_vlocal</b> (int l) const</td></tr>
<tr class="separator:a748a7036e83e7370dfddb1aefb96307e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a4fd4dbd26e10904853f352fb45a84"><td class="memItemLeft" align="right" valign="top"><a id="ae2a4fd4dbd26e10904853f352fb45a84"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>num_core_electrons</b> () const</td></tr>
<tr class="separator:ae2a4fd4dbd26e10904853f352fb45a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0101ceb0ac468dbce5f8cfd0bd8a4544"><td class="memItemLeft" align="right" valign="top"><a id="a0101ceb0ac468dbce5f8cfd0bd8a4544"></a>
const std::vector&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>get_Hrad_el</b> (int l) const</td></tr>
<tr class="separator:a0101ceb0ac468dbce5f8cfd0bd8a4544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5ff2154a5a95a8ac50d215f7bc1db22"><td class="memItemLeft" align="right" valign="top"><a id="ae5ff2154a5a95a8ac50d215f7bc1db22"></a>
const std::vector&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>get_Hrad_mag</b> (int l) const</td></tr>
<tr class="separator:ae5ff2154a5a95a8ac50d215f7bc1db22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96b0f46cdcda5ec1b09c6d28ac92406d"><td class="memItemLeft" align="right" valign="top"><a id="a96b0f46cdcda5ec1b09c6d28ac92406d"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>get_alpha</b> () const</td></tr>
<tr class="separator:a96b0f46cdcda5ec1b09c6d28ac92406d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cec7043536a42aade03df0486d25293"><td class="memItemLeft" align="right" valign="top"><a id="a1cec7043536a42aade03df0486d25293"></a>
const std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>get_core</b> () const</td></tr>
<tr class="separator:a1cec7043536a42aade03df0486d25293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e3eeda63d6f8f5dd1f001cc520c06f"><td class="memItemLeft" align="right" valign="top"><a id="a18e3eeda63d6f8f5dd1f001cc520c06f"></a>
const <a class="el" href="classHF_1_1Breit.html">HF::Breit</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>get_Breit</b> () const</td></tr>
<tr class="separator:a18e3eeda63d6f8f5dd1f001cc520c06f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee82c1b6a1cb08d5f46e30abc90cd55e"><td class="memItemLeft" align="right" valign="top"><a id="aee82c1b6a1cb08d5f46e30abc90cd55e"></a>
<a class="el" href="classDiracSpinor.html">DiracSpinor</a>&#160;</td><td class="memItemRight" valign="bottom"><b>VBr</b> (const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fv) const</td></tr>
<tr class="separator:aee82c1b6a1cb08d5f46e30abc90cd55e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cdcece97255762179463dff21217df3"><td class="memItemLeft" align="right" valign="top"><a id="a6cdcece97255762179463dff21217df3"></a>
<a class="el" href="classHF_1_1HartreeFock.html">HartreeFock</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classHF_1_1HartreeFock.html">HartreeFock</a> &amp;)=delete</td></tr>
<tr class="separator:a6cdcece97255762179463dff21217df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b9e94919489536dbb7a38dc49295a11"><td class="memItemLeft" align="right" valign="top"><a id="a0b9e94919489536dbb7a38dc49295a11"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>HartreeFock</b> (const <a class="el" href="classHF_1_1HartreeFock.html">HartreeFock</a> &amp;)=delete</td></tr>
<tr class="separator:a0b9e94919489536dbb7a38dc49295a11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a034b1dc894ee061406d2e6409d9fd3cb"><td class="memItemLeft" align="right" valign="top"><a id="a034b1dc894ee061406d2e6409d9fd3cb"></a>
static std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHF_1_1HartreeFock.html#a034b1dc894ee061406d2e6409d9fd3cb">calc_vdir_single</a> (const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fa)</td></tr>
<tr class="memdesc:a034b1dc894ee061406d2e6409d9fd3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates single-electron contribution to Vdir (does not include x*[2j+1]). Fa may be any state - calculated on the fly. <br /></td></tr>
<tr class="separator:a034b1dc894ee061406d2e6409d9fd3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ad71e51732076672d748be3facaa88115"><td class="memItemLeft" align="right" valign="top"><a id="ad71e51732076672d748be3facaa88115"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>verbose</b> = true</td></tr>
<tr class="separator:ad71e51732076672d748be3facaa88115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fbe4bbbb7b26891e853136f5e3c10ab"><td class="memItemLeft" align="right" valign="top"><a id="a0fbe4bbbb7b26891e853136f5e3c10ab"></a>
std::shared_ptr&lt; const <a class="el" href="classGrid.html">Grid</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>rgrid</b></td></tr>
<tr class="separator:a0fbe4bbbb7b26891e853136f5e3c10ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Solves relativistic Hartree-Fock equations. </p>
<dl class="section user"><dt>Construction</dt><dd>Requires set of core orbitals + energies that are already solved! (it's the energies that are most important, the energies must already be good guesses). WaveFunction gives routine to solve initial core approx.</dd></dl>
<dl class="section user"><dt>Usage</dt><dd>Solves <a class="el" href="namespaceHF.html" title="Functions and classes for Hartree-Fock. ">HF</a> equations for the core when <a class="el" href="classHF_1_1HartreeFock.html#ae5aa7f2c47d4ce867dc9371fb5c38e13" title="Solves HF equations self-consitantly for core orbs. Produces Vdir. ">solveCore()</a> is called. Core orbitals must already exist. Note: stores a pointer to external core orbitals. These must not be extended/deleted while <a class="el" href="namespaceHF.html" title="Functions and classes for Hartree-Fock. ">HF</a> object exists.</dd></dl>
<dl class="section user"><dt>Definitions:</dt><dd>v^k_ab(r) := Int_0^inf [r_min^k/r_max^(k+1)]*rho(f') dr' rho(r') := fa(r')*fb(r') + ga(r')gb(r') Lambda^k_ab := 3js((ja,jb,k),(-1/2,1/2,0))^2 * parity(la+lb+k) vex[a] := [v_ex*Fa](r) *(Fa/Fa^2) (approx exchange) </dd></dl>
</div><hr/>The documentation for this class was generated from the following file:<ul>
<li>HF/<a class="el" href="HartreeFock_8hpp_source.html">HartreeFock.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
