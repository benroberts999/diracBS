<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ampsci: MBPT::CorrelationPotential</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ampsci
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceMBPT.html">MBPT</a></li><li class="navelem"><a class="el" href="classMBPT_1_1CorrelationPotential.html">CorrelationPotential</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classMBPT_1_1CorrelationPotential-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">MBPT::CorrelationPotential<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Pure virtual. Calculates + stores Correlation Potential operator.  
 <a href="classMBPT_1_1CorrelationPotential.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="CorrelationPotential_8hpp_source.html">CorrelationPotential.hpp</a>&gt;</code></p>

<p>Inherited by MBPT::FeynmanSigma, and <a class="el" href="classMBPT_1_1GoldstoneSigma2.html">MBPT::GoldstoneSigma2</a>.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae0e3c36bbbdac65240ccb79b159c593c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMBPT_1_1CorrelationPotential.html#ae0e3c36bbbdac65240ccb79b159c593c">form_Sigma</a> (const std::vector&lt; double &gt; &amp;en_list={}, const std::string &amp;out_fname=&quot;&quot;)</td></tr>
<tr class="memdesc:ae0e3c36bbbdac65240ccb79b159c593c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forms Correlation potential matrix [called on construct].  <a href="#ae0e3c36bbbdac65240ccb79b159c593c">More...</a><br /></td></tr>
<tr class="separator:ae0e3c36bbbdac65240ccb79b159c593c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f0efd1937cac9831d87e81e2caef1d"><td class="memItemLeft" align="right" valign="top"><a id="ad0f0efd1937cac9831d87e81e2caef1d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMBPT_1_1CorrelationPotential.html#ad0f0efd1937cac9831d87e81e2caef1d">scale_Sigma</a> (const std::vector&lt; double &gt; &amp;lambda_kappa)</td></tr>
<tr class="memdesc:ad0f0efd1937cac9831d87e81e2caef1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores scaling factors, lambda, for each kappa (Sigma -&gt; lamda*Sigma) <br /></td></tr>
<tr class="separator:ad0f0efd1937cac9831d87e81e2caef1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce140949dcb9823ead445a6396d8c6f"><td class="memItemLeft" align="right" valign="top"><a id="a0ce140949dcb9823ead445a6396d8c6f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMBPT_1_1CorrelationPotential.html#a0ce140949dcb9823ead445a6396d8c6f">print_scaling</a> () const</td></tr>
<tr class="memdesc:a0ce140949dcb9823ead445a6396d8c6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the scaling factors to screen. <br /></td></tr>
<tr class="separator:a0ce140949dcb9823ead445a6396d8c6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf6e97d3eba6156063b416141d8f10c8"><td class="memItemLeft" align="right" valign="top"><a id="abf6e97d3eba6156063b416141d8f10c8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMBPT_1_1CorrelationPotential.html#abf6e97d3eba6156063b416141d8f10c8">print_subGrid</a> () const</td></tr>
<tr class="memdesc:abf6e97d3eba6156063b416141d8f10c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the sub-grid parameters to screen. <br /></td></tr>
<tr class="separator:abf6e97d3eba6156063b416141d8f10c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50f72002739f37e8409e939cfadfb1a1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDiracSpinor.html">DiracSpinor</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMBPT_1_1CorrelationPotential.html#a50f72002739f37e8409e939cfadfb1a1">SigmaFv</a> (const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fv) const</td></tr>
<tr class="memdesc:a50f72002739f37e8409e939cfadfb1a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns Spinor: Sigma|Fv&gt;  <a href="#a50f72002739f37e8409e939cfadfb1a1">More...</a><br /></td></tr>
<tr class="separator:a50f72002739f37e8409e939cfadfb1a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9410b10b96f6fa69fde5dba640c1e7bd"><td class="memItemLeft" align="right" valign="top"><a id="a9410b10b96f6fa69fde5dba640c1e7bd"></a>
<a class="el" href="classDiracSpinor.html">DiracSpinor</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator()</b> (const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fv) const</td></tr>
<tr class="separator:a9410b10b96f6fa69fde5dba640c1e7bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93714987f83338eb3858972119a9f7e6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMBPT_1_1CorrelationPotential.html#a93714987f83338eb3858972119a9f7e6">SOEnergyShift</a> (const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fv, const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fw, int max_l=99) const</td></tr>
<tr class="memdesc:a93714987f83338eb3858972119a9f7e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates &lt;Fv|Sigma|Fw&gt; from scratch, at Fv energy [full grid + fg+gg].  <a href="#a93714987f83338eb3858972119a9f7e6">More...</a><br /></td></tr>
<tr class="separator:a93714987f83338eb3858972119a9f7e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a724962278297e1cdaf576da9bd0ec62d"><td class="memItemLeft" align="right" valign="top"><a id="a724962278297e1cdaf576da9bd0ec62d"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>maxk</b> () const</td></tr>
<tr class="separator:a724962278297e1cdaf576da9bd0ec62d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a178adc31e4ab98629fbec2eca24626e0"><td class="memItemLeft" align="right" valign="top"><a id="a178adc31e4ab98629fbec2eca24626e0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setup_subGrid</b> (double rmin, double rmax)</td></tr>
<tr class="separator:a178adc31e4ab98629fbec2eca24626e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af389afaa3bb9a40f7d090aaf0fe41b14"><td class="memItemLeft" align="right" valign="top"><a id="af389afaa3bb9a40f7d090aaf0fe41b14"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>fill_Sigma_k</b> (<a class="el" href="classMBPT_1_1GreenMatrix.html">GMatrix</a> *Gmat, const int kappa, const double en)=0</td></tr>
<tr class="separator:af389afaa3bb9a40f7d090aaf0fe41b14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab53cacfb25f2a5b43777c914ea7e3187"><td class="memItemLeft" align="right" valign="top"><a id="ab53cacfb25f2a5b43777c914ea7e3187"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>addto_G</b> (<a class="el" href="classMBPT_1_1GreenMatrix.html">GMatrix</a> *Gmat, const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;ket, const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;bra, const double f=1.0) const</td></tr>
<tr class="separator:ab53cacfb25f2a5b43777c914ea7e3187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab98c0e64f2cfcae0056f684d3dfb08ca"><td class="memItemLeft" align="right" valign="top"><a id="ab98c0e64f2cfcae0056f684d3dfb08ca"></a>
<a class="el" href="classDiracSpinor.html">DiracSpinor</a>&#160;</td><td class="memItemRight" valign="bottom"><b>act_G_Fv</b> (const <a class="el" href="classMBPT_1_1GreenMatrix.html">GMatrix</a> &amp;Gmat, const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fv) const</td></tr>
<tr class="separator:ab98c0e64f2cfcae0056f684d3dfb08ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44d22d4dfb1a8beeed52dd5a0f7fdf08"><td class="memItemLeft" align="right" valign="top"><a id="a44d22d4dfb1a8beeed52dd5a0f7fdf08"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>act_G_Fv_2</b> (const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fa, const <a class="el" href="classMBPT_1_1GreenMatrix.html">GMatrix</a> &amp;Gmat, const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;Fb) const</td></tr>
<tr class="separator:a44d22d4dfb1a8beeed52dd5a0f7fdf08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f7f9e3e95bbed36210cba70dabaeba9"><td class="memItemLeft" align="right" valign="top"><a id="a2f7f9e3e95bbed36210cba70dabaeba9"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>read_write</b> (const std::string &amp;fname, IO::FRW::RoW rw)</td></tr>
<tr class="separator:a2f7f9e3e95bbed36210cba70dabaeba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4abe87cddc63f77a0048c760fd8088d"><td class="memItemLeft" align="right" valign="top"><a id="af4abe87cddc63f77a0048c760fd8088d"></a>
std::size_t&#160;</td><td class="memItemRight" valign="bottom"><b>ri_subToFull</b> (std::size_t i) const</td></tr>
<tr class="separator:af4abe87cddc63f77a0048c760fd8088d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a027713195a39ff08d723d494df89e1"><td class="memItemLeft" align="right" valign="top"><a id="a5a027713195a39ff08d723d494df89e1"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>dr_subToFull</b> (std::size_t i) const</td></tr>
<tr class="separator:a5a027713195a39ff08d723d494df89e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55942765df8b0f04303d908e1f71a0f2"><td class="memItemLeft" align="right" valign="top"><a id="a55942765df8b0f04303d908e1f71a0f2"></a>
std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>copy_holes</b> (const std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; &amp;basis, const std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; &amp;core, int n_min) const</td></tr>
<tr class="separator:a55942765df8b0f04303d908e1f71a0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f687bb5927c3c722e075122bebefff"><td class="memItemLeft" align="right" valign="top"><a id="ae5f687bb5927c3c722e075122bebefff"></a>
std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>copy_excited</b> (const std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; &amp;basis, const std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; &amp;core) const</td></tr>
<tr class="separator:ae5f687bb5927c3c722e075122bebefff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:acc13899fafcc0dab18697ada1c9eb390"><td class="memItemLeft" align="right" valign="top"><a id="acc13899fafcc0dab18697ada1c9eb390"></a>
std::shared_ptr&lt; const <a class="el" href="classGrid.html">Grid</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>p_gr</b></td></tr>
<tr class="separator:acc13899fafcc0dab18697ada1c9eb390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99a19dd002ddccc4dd2f373538396608"><td class="memItemLeft" align="right" valign="top"><a id="a99a19dd002ddccc4dd2f373538396608"></a>
const std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_holes</b></td></tr>
<tr class="separator:a99a19dd002ddccc4dd2f373538396608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf04db705406499a4ccbac540e03c9e9"><td class="memItemLeft" align="right" valign="top"><a id="abf04db705406499a4ccbac540e03c9e9"></a>
const std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_excited</b></td></tr>
<tr class="separator:abf04db705406499a4ccbac540e03c9e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a066398e27b57be6e03868c2f310b5030"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMBPT_1_1CorrelationPotential.html#a066398e27b57be6e03868c2f310b5030">CorrelationPotential</a> (const <a class="el" href="classHF_1_1HartreeFock.html">HF::HartreeFock</a> *const in_hf, const std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; &amp;basis, const Sigma_params &amp;sigp, const rgrid_params &amp;subgridp)</td></tr>
<tr class="memdesc:a066398e27b57be6e03868c2f310b5030"><td class="mdescLeft">&#160;</td><td class="mdescRight">If given (optional) en_list, will form Sigma matrix.  <a href="#a066398e27b57be6e03868c2f310b5030">More...</a><br /></td></tr>
<tr class="separator:a066398e27b57be6e03868c2f310b5030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9318d6f375a0915d021026752ff805a1"><td class="memItemLeft" align="right" valign="top"><a id="a9318d6f375a0915d021026752ff805a1"></a>
<a class="el" href="classMBPT_1_1CorrelationPotential.html">CorrelationPotential</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classMBPT_1_1CorrelationPotential.html">CorrelationPotential</a> &amp;)=delete</td></tr>
<tr class="separator:a9318d6f375a0915d021026752ff805a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1256bdf6df793256c8cfbc953dd5088a"><td class="memItemLeft" align="right" valign="top"><a id="a1256bdf6df793256c8cfbc953dd5088a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CorrelationPotential</b> (const <a class="el" href="classMBPT_1_1CorrelationPotential.html">CorrelationPotential</a> &amp;)=delete</td></tr>
<tr class="separator:a1256bdf6df793256c8cfbc953dd5088a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1afb93fa2a9030a428d75987f268880a"><td class="memItemLeft" align="right" valign="top"><a id="a1afb93fa2a9030a428d75987f268880a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>get_fk</b> (int k) const</td></tr>
<tr class="separator:a1afb93fa2a9030a428d75987f268880a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a0300b3fa6036e9a718ecb69a49729fd3"><td class="memItemLeft" align="right" valign="top"><a id="a0300b3fa6036e9a718ecb69a49729fd3"></a>
<a class="el" href="classCoulomb_1_1YkTable.html">Coulomb::YkTable</a>&#160;</td><td class="memItemRight" valign="bottom"><b>m_yeh</b></td></tr>
<tr class="separator:a0300b3fa6036e9a718ecb69a49729fd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f2e00a5a26c075f33d37f5ad4088fce"><td class="memItemLeft" align="right" valign="top"><a id="a5f2e00a5a26c075f33d37f5ad4088fce"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>m_maxk</b></td></tr>
<tr class="separator:a5f2e00a5a26c075f33d37f5ad4088fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab970789f12bdece4dd8c1deb1307b759"><td class="memItemLeft" align="right" valign="top"><a id="ab970789f12bdece4dd8c1deb1307b759"></a>
<a class="el" href="classAngular_1_1SixJ.html">Angular::SixJ</a>&#160;</td><td class="memItemRight" valign="bottom"><b>m_6j</b></td></tr>
<tr class="separator:ab970789f12bdece4dd8c1deb1307b759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af21ca04d2b7f7a29c9300b1f71f2f5d3"><td class="memItemLeft" align="right" valign="top"><a id="af21ca04d2b7f7a29c9300b1f71f2f5d3"></a>
std::size_t&#160;</td><td class="memItemRight" valign="bottom"><b>m_stride</b></td></tr>
<tr class="separator:af21ca04d2b7f7a29c9300b1f71f2f5d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1adabffa1f2039eb2bbcbaa52a221ba"><td class="memItemLeft" align="right" valign="top"><a id="aa1adabffa1f2039eb2bbcbaa52a221ba"></a>
std::size_t&#160;</td><td class="memItemRight" valign="bottom"><b>m_subgrid_points</b> {}</td></tr>
<tr class="separator:aa1adabffa1f2039eb2bbcbaa52a221ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9a967e6c2e99083f7d9408a340c7c24"><td class="memItemLeft" align="right" valign="top"><a id="aa9a967e6c2e99083f7d9408a340c7c24"></a>
std::size_t&#160;</td><td class="memItemRight" valign="bottom"><b>m_imin</b> {}</td></tr>
<tr class="separator:aa9a967e6c2e99083f7d9408a340c7c24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66cad3cf6f116b35091e4c33b1fc4a30"><td class="memItemLeft" align="right" valign="top"><a id="a66cad3cf6f116b35091e4c33b1fc4a30"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_subgrid_r</b> {}</td></tr>
<tr class="separator:a66cad3cf6f116b35091e4c33b1fc4a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a197d9130edb2c4cf09ddcc0a2baef770"><td class="memItemLeft" align="right" valign="top"><a id="a197d9130edb2c4cf09ddcc0a2baef770"></a>
std::vector&lt; <a class="el" href="classMBPT_1_1GreenMatrix.html">GMatrix</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_Sigma_kappa</b> {}</td></tr>
<tr class="separator:a197d9130edb2c4cf09ddcc0a2baef770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c6e89bee2b2d53fe6c2ff7ddf13188f"><td class="memItemLeft" align="right" valign="top"><a id="a9c6e89bee2b2d53fe6c2ff7ddf13188f"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_lambda_kappa</b> {}</td></tr>
<tr class="separator:a9c6e89bee2b2d53fe6c2ff7ddf13188f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a597972ab7a42c93e4bc9f5040e63b526"><td class="memItemLeft" align="right" valign="top"><a id="a597972ab7a42c93e4bc9f5040e63b526"></a>
const bool&#160;</td><td class="memItemRight" valign="bottom"><b>m_include_G</b></td></tr>
<tr class="separator:a597972ab7a42c93e4bc9f5040e63b526"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a14f7eb3335a8c15065a629aa537aa"><td class="memItemLeft" align="right" valign="top"><a id="a44a14f7eb3335a8c15065a629aa537aa"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_fk</b> {}</td></tr>
<tr class="separator:a44a14f7eb3335a8c15065a629aa537aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Pure virtual. Calculates + stores Correlation Potential operator. </p>
<p>Takes core+excited basis orbitals, and a list of energies. Must be one energy per kappa, in order starting from k=-1 (no gaps). Correlation potential is formed for each kappa for which an energy is given, at the given energy.</p>
<p>Can calculate second-order <a class="el" href="namespaceMBPT.html" title="Many-body perturbation theory. ">MBPT</a> energy shifts without forming matrix (give blank energy list).</p>
<p>in_fname: will read/write to this file. If the file exists, will read Sigma from it. If file doesn't exist, will calculate Sigma and write it to file. If blank filename is given, will not try to write.</p><ul>
<li>Note: program appends ".Sigma" extension, don't include this in filename.</li>
<li>Note: only writes sigma, not scaling factors </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a066398e27b57be6e03868c2f310b5030"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a066398e27b57be6e03868c2f310b5030">&#9670;&nbsp;</a></span>CorrelationPotential()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MBPT::CorrelationPotential::CorrelationPotential </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classHF_1_1HartreeFock.html">HF::HartreeFock</a> *const&#160;</td>
          <td class="paramname"><em>in_hf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Sigma_params &amp;&#160;</td>
          <td class="paramname"><em>sigp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const rgrid_params &amp;&#160;</td>
          <td class="paramname"><em>subgridp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If given (optional) en_list, will form Sigma matrix. </p>
<p>if given filename, will read Sigma in from file instead of calculating it. If given filename for file that doesn't exist yet, will write sigma to that file. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae0e3c36bbbdac65240ccb79b159c593c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0e3c36bbbdac65240ccb79b159c593c">&#9670;&nbsp;</a></span>form_Sigma()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MBPT::CorrelationPotential::form_Sigma </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>en_list</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>out_fname</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forms Correlation potential matrix [called on construct]. </p>
<p>Forms for each kappa at given energy. One energy must be given per kappa. </p>

</div>
</div>
<a id="a50f72002739f37e8409e939cfadfb1a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50f72002739f37e8409e939cfadfb1a1">&#9670;&nbsp;</a></span>SigmaFv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDiracSpinor.html">DiracSpinor</a> MBPT::CorrelationPotential::SigmaFv </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;&#160;</td>
          <td class="paramname"><em>Fv</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns Spinor: Sigma|Fv&gt; </p>
<p>If Sigma for kappa_v doesn't exist, returns |0&gt;. m_Sigma_kappa calculated at the energy given in 'form_Sigma' (or on construct) </p>

</div>
</div>
<a id="a93714987f83338eb3858972119a9f7e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93714987f83338eb3858972119a9f7e6">&#9670;&nbsp;</a></span>SOEnergyShift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double MBPT::CorrelationPotential::SOEnergyShift </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;&#160;</td>
          <td class="paramname"><em>Fv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDiracSpinor.html">DiracSpinor</a> &amp;&#160;</td>
          <td class="paramname"><em>Fw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_l</em> = <code>99</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates &lt;Fv|Sigma|Fw&gt; from scratch, at Fv energy [full grid + fg+gg]. </p>
<p>Note: uses basis, so if reading Sigma from file, and no basis given, will return all 0.0 </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>MBPT/<a class="el" href="CorrelationPotential_8hpp_source.html">CorrelationPotential.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
